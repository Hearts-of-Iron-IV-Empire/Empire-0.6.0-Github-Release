SPR_colonial_management = {
	SPR_treasure_fleet_from_the_americas = {

		icon = generic_naval

		available = {
			NOT = {
				MEX = { is_subject_of = SPR }
				PRU = { is_subject_of = SPR }
			}
		}

		days_mission_timeout = 180

		fixed_random_seed = no

		fire_only_once = no

		is_good = yes
		timeout_effect = {
			if = {	
				limit = {
					NOT = { 
						has_completed_focus = SPR_protect_the_treasure_fleets 
						has_completed_focus = SPR_destroy_the_pirate_scum
					}
				}
				random_list = {
					45 = { # Small 
						country_event = spain.13
					}
					30 = { # Medium
						country_event = spain.12
					}
					20 = { # Large
						country_event = spain.11
					}
					5 = { # Lost at sea
						country_event = spain.14
					}
				}
			}
			else_if = {	
				limit = {
					has_completed_focus = SPR_protect_the_treasure_fleets
				}
				random_list = {
					43 = { # Small
						country_event = spain.13
					}
					33 = { # Medium
						country_event = spain.12
					}
					22 = { # Large
						country_event = spain.11
					}
					2 = { # Lost at sea
						country_event = spain.14
					}
				}
			}
			else_if = {
				limit = {
					has_completed_focus = SPR_destroy_the_pirate_scum
				}
				random_list = {
					50 = { # Small
						country_event = spain.13
					}
					30 = { # Medium
						country_event = spain.12
					}
					20 = { # Large
						country_event = spain.11
					}
				}
			}
		}
	}
}

estate_interactions = {
	SPR_estates_of_majorca_announce_allegiance = {
		icon = generic_nationalism

		available = {
			NOT = { SPR= { owns_state = 177 } }
		}

		days_mission_timeout = 140

		activation = {
			always = no #Triggered from effect
		}

		visible = {
			
		}		

		is_good = yes

		fixed_random_seed = no

		timeout_effect = {
			if = { 
				limit = { 
					has_completed_focus = SPR_appeal_to_aragonese_loyalists
				}
				country_event = {
					id = spain.18
				}
			}
			else = {
				random_list = {
					50 = {
						country_event = {
							id = spain.18
						}
					}
					50 = {
						country_event = {
							id = spain.19
						}
					}
				}
			}
		}
	}

	SPR_estates_of_sardinia_announce_allegiance = {
		icon = generic_nationalism

		available = {
			NOT = { SPR= { owns_state = 114 } }
		}

		days_mission_timeout = 150

		activation = {
			always = no #Triggered from effect
		}

		visible = {
			
		}		

		is_good = yes
		fixed_random_seed = no

		timeout_effect = {
			if = { 
				limit = { 
					has_completed_focus = SPR_appeal_to_aragonese_loyalists
				}
				random_list = {
					100 = {
						country_event = spain.20
					}
				}
			}
			else = {
				random_list = {
					50 = {
						country_event = spain.20
					}
					50 = {
						country_event = spain.21
					}
				}
			}
		}
	}
	
	SPR_estates_of_naples_announce_allegiance = {
		icon = generic_nationalism

		available = {
			NOT = { TSC = { is_subject_of = SPR } }
		}

		days_mission_timeout = 160

		activation = {
			always = no #Triggered from effect
		}

		visible = {
		}		

		is_good = yes
		timeout_effect = {
			TSC = { country_event = spain.24 }
		}
	}

	SPR_estates_of_valencia_announce_allegiance = {
		icon = generic_nationalism

		available = {
			NOT = { SPR = { owns_state = 167 } }
		}

		days_mission_timeout = 170

		activation = {
			always = no #Triggered from effect
		}

		visible = {			
		}		

		is_good = yes
		fixed_random_seed = no

		timeout_effect = {
			random_list = {
				25 = {
					country_event = spain.22
				}
				75 = {
					country_event = spain.23
				}
			}
		}
	}

	SPR_estates_of_aragon_announce_allegiance = {
		icon = generic_nationalism

		available = {
			NOT = { 
				SPR = { 
					owns_state = 166
					owns_state = 876
				} 
			}
		}

		days_mission_timeout = 180

		activation = {
			always = no #Triggered from effect
		}

		visible = {
			
		}		

		is_good = yes
		fixed_random_seed = no

		timeout_effect = {
			random_list = {
				25 = {
					country_event = spain.27
				}
				75 = {
					country_event = spain.28
				}
			}
		}
	}

	SPR_estates_of_catalonia_announce_allegiance = {
		icon = generic_nationalism

		available = {
			NOT = { SPR= { owns_state = 165 } }
		}

		days_mission_timeout = 190

		activation = {
			always = no #Triggered from effect
		}

		visible = {
			
		}		

		is_good = yes
		fixed_random_seed = no

		timeout_effect = {
			if = { 
				limit = { 
					has_completed_focus = SPR_appeal_to_aragonese_loyalists
				}
				random_list = {
					100 = {
						country_event = spain.30
					}
				}
			}
			else = {
				random_list = {
					25 = {
						country_event = spain.29
					}
					75 = {
						country_event = spain.30
					}
				}
			}
		}
	}
	SPR_estates_of_sicily_announce_allegiance = {
		icon = generic_nationalism

		available = {
			NOT = { SPR = { owns_state = 115 } }
		}

		days_mission_timeout = 200

		activation = {
			always = no #Triggered from effect
		}

		visible = {
			
		}		

		is_good = yes
		fixed_random_seed = no

		timeout_effect = {
			set_country_flag = SPR_estate_missions_done
			if = { 
				limit = { 
					has_completed_focus = SPR_appeal_to_aragonese_loyalists
				}
				random_list = {
					100 = {
						country_event = spain.31
					}
				}
			}
			else = {
				random_list = {
					50 = {
						country_event = spain.31
					}
					50 = {
						country_event = spain.32
					}
				}
			}
		}
	}
	SPR_impending_aragonese_revolt = {
		icon = generic_naval

		available = {
			always = no
		}

		days_mission_timeout = 360

		activation = {
			has_country_flag = SPR_estate_missions_done
		}

		visible = {
			
		}	

		fire_only_once = yes

		is_good = no
		timeout_effect = {
			country_event = spain.3
		}
	}
}

SPR_economic_reforms_category = {
	SPR_reform_the_administration = {
		icon = generic_political_discourse

		available = {
			has_completed_focus = SPR_spanish_recovery_plan
		}
		
		visible = {
			has_completed_focus = SPR_spanish_recovery_plan
		}

		cost = 70

		days_remove = 75

		fire_only_once = yes

		modifier = {
			political_power_cost = 0.15
		}

		remove_effect = {
			SPR_improve_economy = yes # Makes it SPR_economic_recovery_2
		}

		ai_will_do = {
			factor = 100
		}
	}

	SPR_establish_economic_societies = {
		icon = eng_trade_unions_support

		available = {
			has_completed_focus = SPR_spanish_recovery_plan
		}
		
		visible = {
			has_completed_focus = SPR_spanish_recovery_plan
		}

		cost = 50

		days_remove = 75

		fire_only_once = yes

		modifier = {
			political_power_cost = 0.15
		}

		remove_effect = {
			add_ideas =	SPR_economic_societies
			set_country_flag = spr_establish_economic_societies_flag
		}

		ai_will_do = {
			factor = 100
		}
	}

	SPR_improve_economic_societies = {

		available = {
			hidden_trigger = {
				has_country_flag = spr_establish_economic_societies_flag
			}
		}
		
		visible = {
			has_completed_focus = SPR_spanish_recovery_plan
		}

		cost = 70

		fire_only_once = yes

		remove_effect = {
			swap_ideas = {
				remove_idea = SPR_economic_societies
				add_idea = SPR_economic_societies_2
			}
		}

		ai_will_do = {
			factor = 100
		}
	}

	SPR_promote_state_spending = {
		icon = burghers

		available = {
			has_completed_focus = SPR_spanish_recovery_plan
		}
		
		visible = {
			has_completed_focus = SPR_spanish_recovery_plan
			has_idea = SPR_economic_recovery_2
		}

		cost = 70

		days_remove = 70

		fire_only_once = yes

		modifier = {
			consumer_goods_factor = 0.10
		}

		remove_effect = {
			SPR_improve_economy = yes # Makes it SPR_economic_recovery_3
		}

		ai_will_do = {
			factor = 100
		}
	}

	SPR_combat_inflation = {
		icon = coins

		available = {
			has_completed_focus = SPR_spanish_recovery_plan
		}
		
		visible = {
			has_completed_focus = SPR_spanish_recovery_plan
			has_idea = SPR_economic_recovery_3
		}

		cost = 130

		days_remove = 100

		fire_only_once = yes

		modifier = {
			consumer_goods_factor = 0.05
			political_power_cost = 0.10
		}

		remove_effect = {
			SPR_improve_economy = yes # Makes it SPR_economic_recovery_4
		}

		ai_will_do = {
			factor = 100
		}
	}

	SPR_reform_the_exchequer = {
		icon = eng_trade_unions_demand

		available = {
			has_completed_focus = SPR_spanish_recovery_plan
		}
		
		visible = {
			has_completed_focus = SPR_spanish_recovery_plan
			has_idea = SPR_economic_recovery_4
		}

		cost = 100

		days_remove = 80

		fire_only_once = yes

		modifier = {
			political_power_cost = 0.10
		}

		remove_effect = {
			SPR_improve_economy = yes # Makes it SPR_economic_recovery_5
		}

		ai_will_do = {
			factor = 100
		}
	}

	SPR_finalize_economic_reforms = {

		available = {
			has_completed_focus = SPR_spanish_recovery_plan
		}
		
		visible = {
			has_completed_focus = SPR_spanish_recovery_plan
			has_idea = SPR_economic_recovery_5
		}

		cost = 50

		fire_only_once = yes

		complete_effect = {
			SPR_improve_economy = yes # Removes the idea
			set_country_flag = completed_economic_reforms
		}

		ai_will_do = {
			factor = 100
		}
	}
}

SPR_overseas_colonies_category = {
	SPR_provide_colonial_funds = {
		icon = coins
		
		cost = 50

		custom_cost_trigger = {
			check_variable = {
				colonial_funding > 0
			}
		}
		custom_cost_text = decision_give_400_reales

		days_remove = 40

		modifier = {
			consumer_goods_factor = 0.05
		}

		complete_effect = {
			add_to_variable = {
				var = colonial_funding
				value = 400
			}
		}

		ai_will_do = {
			factor = 20
		}
	}
	SPR_eliminate_creole_influence = {
		icon = oppression
		
		cost = 50

		custom_cost_trigger = {
			check_variable = {
				colonial_funding > 400
			}
		}
		custom_cost_text = decision_cost_400_reales
		complete_effect = {
			add_to_variable = {
				var = creole_elite_influence
				value = -10
			}
			add_to_variable = {
				var = crown_influence
				value = 5
			}
			clamp_variable = { var = creole_elite_influence min = 0 max = 100 }
			clamp_variable = { var = crown_influence min = 0 max = 100 }
			add_to_variable = {
				var = colonial_funding
				value = -400
			}
			custom_effect_tooltip = decrease_10_increase_5
		}

		ai_will_do = {
			factor = 20
			modifier = {
				if = {
					limit = {
						check_variable = { creole_elite_influence > 70 }
					}
				}
				add = 30
			}
		}
	}
	SPR_send_in_the_military = {
		icon = generic_military

		available = {
			has_completed_focus = SPR_reinforce_colonial_garrisons
		}
		
		cost = 50

		custom_cost_trigger = {
			check_variable = {
				colonial_funding > 250
			}
		}
		custom_cost_text = decision_cost_250_reales

		days_remove = 20

		modifier = {
			political_power_cost = 0.05
		}

		complete_effect = {
			add_to_variable = {
				var = creole_elite_influence
				value = -15
			}
			add_to_variable = {
				var = crown_influence
				value = 10
			}
			clamp_variable = { var = creole_elite_influence min = 0 max = 100 }
			clamp_variable = { var = crown_influence min = 0 max = 100 }
			add_to_variable = {
				var = colonial_funding
				value = -250
			}
			add_stability = -0.025
			add_war_support = 0.025
			add_manpower = -200
			add_equipment_to_stockpile = {
				type = infantry_equipment
				amount = -200
			}
			custom_effect_tooltip = will_increase_our_influence
		}

		ai_will_do = {
			factor = 20
			modifier = {
				if = {
					limit = {
						check_variable = { creole_elite_influence > 50 }
					}
				}
				add = 30
			}
		}
	}
	SPR_establish_trading_companies = {

		available = {
			check_variable = { creole_elite_influence < 50 }
		}
		
		visible = {
			has_completed_focus = SPR_establish_royal_monopolies
		}

		cost = 70
		
		custom_cost_trigger = {
			has_completed_focus = SPR_establish_royal_monopolies
		}
		custom_cost_text = decision_give_300_reales

		days_remove = 80

		fire_only_once = yes

		complete_effect = {
			add_to_variable = {
				var = colonial_funding
				value = 300
			}

			set_country_flag = established_trading_companies
		}

		remove_effect = {
			add_ideas = SPR_royal_trading_companies
		}

		ai_will_do = {
			factor = 20
		}
	}
	SPR_conscript_colonial_populace = {

		available = {
			check_variable = { creole_elite_influence < 50 }
		}
		
		visible = {
			has_completed_focus = SPR_reinforce_colonial_garrisons
		}

		cost = 60

		days_re_enable = 70

		custom_cost_trigger = {
			has_completed_focus = SPR_reinforce_colonial_garrisons
		}
		custom_cost_text = decision_cost_300_reales

		complete_effect = {
			add_stability = -0.02
			add_manpower = 3000
			add_to_variable = {
				var = colonial_funding
				value = -300
			}
		}

		ai_will_do = {
			factor = 20
		}
	}
	SPR_spread_the_faith = {

		icon = clergy
		
		visible = {
			has_completed_focus = SPR_spread_the_true_faith
		}

		cost = 30

		custom_cost_trigger = {
			has_completed_focus = SPR_spread_the_true_faith
		}
		custom_cost_text = decision_cost_500_reales

		complete_effect = {
			add_stability = 0.05
			add_popularity = {
				ideology = fascism
				popularity = 0.05
			}
			add_to_variable = {
				var = creole_elite_influence
				value = -10
			}
			add_to_variable = {
				var = crown_influence
				value = 10
			}
			clamp_variable = { var = creole_elite_influence min = 0 max = 100 }
			clamp_variable = { var = crown_influence min = 0 max = 100 }
			add_to_variable = {
				var = colonial_funding
				value = -500
			}

			custom_effect_tooltip = church_power
		}

		ai_will_do = {
			factor = 20
		}
	}
}